getwd()
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB","tidyverse")
lapply(paketit,library,character.only=T)
getwd()
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB")
lapply(paketit,library,character.only=T)
data<-read.csv("OrtolanBunting.csv")
#tarkasta kaikkien luokkien muoto
data$id<-as.factor(data$id)
#pitäisikö vuosi olla factor vai integer?
data$fyear<-as.factor(data$year)
names(data)
summary(data)
str(data)
#outliers
dotchart(data$terri, main= "territories")
dotchart(data$prec, main= "precipitation")
dotchart(data$prec, main= "precipitation")
dotchart(data$temp, main= "temperature")
dotchart(data$open, main= "spring sown")
dotchart(data$SSS, main= "small-scale structures")
hist(data$terri)
#relationships
pairs.panels(data[,c(4:7,8:9,21:23,28:30)])
#plottailua
xyplot(terri~year|id, data=data)
boxplot(terri~year, data=data)
boxplot(data$terri~data$id, data=data)
xyplot(terri~SSS, data=data)
xyplot(terri~open, data=data)
boxplot(terri~year, data=data)
boxplot(terri~id, data=data)
xyplot(terri~SSS, data=data)
xyplot(terri~open, data=data)
xyplot(terri~cover, data=data)
#varsinaiset mallit:
M1=glmmTMB(terri ~ year + (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M1)
M2=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year + (1|fyear) + (1|id), family=nbinom2, data=data)
M3=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year*temp + year*prec + year*ndvi  + (1|fyear) + (1|id), family=list(family="nbinom2",link="log"), data=data)
M3=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year*temp + year*prec + year*ndvi  + (1|fyear) + (1|id), family=nbinom2, data=data)
View(data)
#varsinaiset mallit:
M1=glmmTMB(terri ~ agri5 + (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M1)
#varsinaiset mallit:
M1=glmmTMB(terri ~ year + (1|id), family=nbinom2, data=data)
summary(M1)
#varsinaiset mallit:
M1=glmmTMB(terri ~ year + (1|fyear) + (1|id), family=nbinom2, data=data)
#varsinaiset mallit:
M1=glmmTMB(terri ~ year  + (1|id), family=nbinom2, data=data)
summary(M1)
M2=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year  + (1|id), family=nbinom2, data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5  + X*Y + year  + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5  + X*Y + year  + (1|id), family="nbinom2", data=data)
#varsinaiset mallit:
M1=glmmTMB(terri ~ year  + (1|id), family="nbinom2", data=data)
summary(M1)
M3=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year*temp + year*prec + year*ndvi   + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5  + X*Y + year  + (1|id), family="nbinom2", data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5  + year+ X*Y  + (1|id), family="nbinom2", data=data)
M2=glmmTMB(terri ~ SSS + agri5  + year+ X*Y  + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ year+ X*Y  + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5  +  X*Y  + (1|id), family=nbinom2, data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5  +  year + (1|id), family=nbinom2, data=data)
#varsinaiset mallit:
M1=glmmTMB(terri ~ year  + (1|id), family=nbinom2, data=data)
summary(M1)
#varsinaiset mallit:
M1=glmmTMB(terri ~ fyear  + (1|id), family=nbinom2, data=data)
summary(M1)
M2=glmmTMB(terri ~ SSS + agri5  +  fyear+ X*Y  + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5  +  fyear  + (1|id), family=nbinom2, data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5  +  fyear + X*Y  + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5  +  year  + (1|id), family=nbinom2, data=data)
#plottailua
xyplot(terri~year|id, data=data)
getwd()
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB")
lapply(paketit,library,character.only=T)
data<-read.csv("OrtolanBunting.csv")
#tarkasta kaikkien luokkien muoto
data$id<-as.factor(data$id)
#pitäisikö vuosi olla factor vai integer?
data$fyear<-as.factor(data$year)
names(data)
summary(data)
str(data)
#outliers
dotchart(data$terri, main= "territories")
dotchart(data$prec, main= "precipitation")
dotchart(data$temp, main= "temperature")
dotchart(data$open, main= "spring sown")
dotchart(data$SSS, main= "small-scale structures")
hist(data$terri)
#relationships
pairs.panels(data[,c(4:7,8:9,21:23,28:30)])
#plottailua
xyplot(terri~year|id, data=data)
boxplot(terri~year, data=data)
boxplot(terri~id, data=data)
xyplot(terri~SSS, data=data)
xyplot(terri~open, data=data)
xyplot(terri~cover, data=data)
M1=glmmTMB(terri ~ year + (1|fyear) + (1|id), family=nbinom2, data=data)
M1=glmmTMB(terri ~ year  + (1|id), family=nbinom2, data=data)
getwd()
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB")
lapply(paketit,library,character.only=T)
data<-read.csv("OrtolanBunting.csv")
#tarkasta kaikkien luokkien muoto
data$id<-as.factor(data$id)
#pitäisikö vuosi olla factor vai integer?
data$fyear<-as.factor(data$year)
names(data)
summary(data)
str(data)
#outliers
dotchart(data$terri, main= "territories")
dotchart(data$prec, main= "precipitation")
dotchart(data$temp, main= "temperature")
dotchart(data$open, main= "spring sown")
dotchart(data$SSS, main= "small-scale structures")
hist(data$terri)
#relationships
pairs.panels(data[,c(4:7,8:9,21:23,28:30)])
#plottailua
xyplot(terri~year|id, data=data)
boxplot(terri~year, data=data)
boxplot(terri~id, data=data)
xyplot(terri~SSS, data=data)
xyplot(terri~open, data=data)
xyplot(terri~cover, data=data)
#esimerkit:
#m1=glmmTMB(N ~Year + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m2=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m3=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Temp + Year*Rain + Year*NDVI + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m4=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Cropdiv + Year*Plough + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m5=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Temp + Year*Rain + Year*NDVI + Year*Cropdiv + Year*Plough + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#varsinaiset mallit:
M1=glmmTMB(terri ~ year + (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M1)
#M2=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year + (1|fyear) + (1|id), family=nbinom2, data=data)
#summary(M2)
#M3=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year*temp + year*prec + year*ndvi  + (1|fyear) + (1|id), family=nbinom2, data=data)
#summary(M3)
#M4=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year*shan + year*open + (1|fyear) + (1|id), family=nbinom2, data=data)
#summary(M4)
#M5=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year*temp + year*prec + year*ndvi + year*shan + year*open + (1|fyear) + (1|id), family=nbinom2, data=data)
#summary(M5)
M1=glmmTMB(terri ~ year  + (1|id), family=nbinom2, data=data)
summary(M1)
M1=glmmTMB(terri ~ year  + (1|fyear/id), family=nbinom2, data=data)
M1=glmmTMB(terri ~ year  + (1|year/id), family=nbinom2, data=data)
M1=glmmTMB(terri ~ year  + (1|id), family=nbinom2, data=data)
summary(M1)
M2=glmmTMB(terri ~ SSS + agri5  +  year   + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5  +  year   + (1|id), family=nbinom2, data=data)
summary(M2)
table(data$id)
summary(M1)
summary(M2)
#varsinaiset mallit:
M1=glmmTMB(terri ~ year  + (1|id), family=nbinom2, data=data)
summary(M1)
table(data$id)
M2=glmmTMB(terri ~ SSS + agri5  +  year   + (1|id), family=nbinom2, data=data)
summary(M2)
M3=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year*temp + year*prec + year*ndvi   + (1|id), family=nbinom2, data=data)
summary(M1)
xyplot(terri~id|year, data=data)
xyplot(terri~id|fyear, data=data)
M1=glmmTMB(terri ~ 1 + (1|fyear)+ (1|id), family=nbinom2, data=data)
summary(M1)
M2=glmmTMB(terri ~ SSS + agri5  +   (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5  +  X*Y + (1|fyear) + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5  +  X+Y + (1|fyear) + (1|id), family=nbinom2, data=data)
M1=glmmTMB(terri ~ year + (1|fyear)+ (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5   + (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5  +  X+Y + (1|fyear) + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5  +  X*Y + (1|fyear) + (1|id), family=nbinom2, data=data)
M3=glmmTMB(terri ~ SSS + agri5 + year*temp + year*prec   + (1|id), family=nbinom2, data=data)
data %>%
mutate_at(c(4,5,6,7,9:30), funs(c(scale(.))))
View(data)
M1=glmmTMB(terri ~ year + (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M1)
M1=glmmTMB(terri ~ 1 + (1|fyear)+ (1|id), family=nbinom2, data=data)
summary(M1)
M2=glmmTMB(terri ~ SSS + agri5  +  X*Y + (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M2)
M3=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year*temp + year*prec + year*ndvi   + (1|id), family=nbinom2, data=data)
summary(M3)
names(data)
M2=glmmTMB(terri ~ SSS + agri5   + (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5   + X+(1|fyear) + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5   + oil + (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5   + Y + (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M2)
data=data %>%
mutate_at(c(4,5,6,7,9:30), funs(c(scale(.))))
M1=glmmTMB(terri ~ 1 + (1|fyear)+ (1|id), family=nbinom2, data=data)
M1=glmmTMB(terri ~ year + (1|fyear)+ (1|id), family=nbinom2, data=data)
summary(M1)
M2=glmmTMB(terri ~ SSS + agri5   + Y + (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5   + X*Y + (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5   + X*Y + year+ (1|fyear) + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5   + X*Y + (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M2)
M3=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec + year*ndvi + (1|fyear)  + (1|id), family=nbinom2, data=data)
M3=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec  + (1|fyear)  + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5   + X*Y + (1|year) + (1|id), family=nbinom2, data=data)
summary(M2)
M3=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec  + (1|year)  + (1|id), family=nbinom2, data=data)
M3=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp   + (1|year)  + (1|id), family=nbinom2, data=data)
M3=glmmTMB(terri ~ SSS + agri5 + X*Y   + (1|year)  + (1|id), family=nbinom2, data=data)
4*37,5
4*37.5
M3=glmmTMB(terri ~ SSS + agri5 + X*Y + temp + year*prec  + (1|year)  + (1|id), family=nbinom2, data=data)
M3=glmmTMB(terri ~ SSS + agri5 + X*Y + temp + prec  + (1|year)  + (1|id), family=nbinom2, data=data)
summary(M3)
29/7.25
M1=lmer(terri ~ year + (1|fyear)+ (1|id), family=nbinom2, data=data)
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB","lmer4")
lapply(paketit,library,character.only=T)
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB","lme4")
lapply(paketit,library,character.only=T)
M1=lmer(terri ~ year + (1|fyear)+ (1|id), family=nbinom2, data=data)
M1=glmer(terri ~ year + (1|fyear)+ (1|id), family=nbinom2, data=data)
summary(M1)
M2=glmmTMB(terri ~ SSS + agri5   + X*Y + (1|year) + (1|id), family=nbinom1, data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5   + X*Y + (1|year) + (1|id), family=nbinom2, data=data)
summary(M2)
