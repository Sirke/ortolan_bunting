#jos halutaan vielä tiivistää viljelykasveja
data<-mutate(data, open = cere+vege+oil+prot) #pitäisikö vielä lisätä herb, fruit ja spec (ruokohelpi)? entäpä 9999?
data<-mutate(data, cover = gras+wint)
#muutetaan pinta-ala neliökilometreiksi
data$area=data$area/1000000
data<-mutate(data, Abuild = build/area)
data<-mutate(data, Ariver = river/area)
data<-mutate(data, Astream = stream/area)
data<-mutate(data, Aroad = roads/area)
data<-dplyr::mutate(data, SSS = Abuild+Aroad+Ariver+Astream)
names(data)
data<-data[,c(1:2,4:5,7:8,12:13,249:250,261:268)]
koord=dplyr::select(koord,id,X,Y)
data<-left_join(data,koord,by="id")
names(data)
data=data %>% drop_na("terri")
write.csv(data,"OrtolanBunting.csv",row.names = F)
getwd()
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB","lme4","MASS","MuMIn","mgcv")
lapply(paketit,library,character.only=T)
data<-read.csv("OrtolanBunting.csv")
names(data)
str(data)
summary(data)
#tarkasta kaikkien luokkien muoto
data$id<-as.factor(data$id)
#vuodelle oma faktori-muuttuja
data$fyear<-as.factor(data$year)
#outliers
dotchart(data$terri, main= "territories")
dotchart(data$prec, main= "precipitation")
dotchart(data$temp, main= "temperature")
dotchart(data$open, main= "spring sown")
dotchart(data$SSS, main= "small-scale structures")
hist(data$terri)
#kuinka monta käyntikertaa per osapopulaatio?
table(data$id)
#relationships
pairs.panels(data[,c(3:21)])
#plottailua
xyplot(terri~fyear|id, data=data)
boxplot(terri~fyear, data=data)
boxplot(terri~id, data=data)
xyplot(terri~SSS, data=data)
xyplot(terri~open, data=data)
xyplot(terri~cover, data=data)
#Aksun esimerkit (näissä mukana NDVI):
#m1=glmmTMB(N ~Year + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m2=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m3=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Temp + Year*Rain + Year*NDVI + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m4=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Cropdiv + Year*Plough + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m5=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Temp + Year*Rain + Year*NDVI + Year*Cropdiv + Year*Plough + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
dataS=data %>%
mutate_at(c(2:3,5:7,9:20), funs(c(scale(.))))
M1=glmmTMB(terri ~ year + (1|fyear)+ (1|id), family=nbinom2, data=dataS)
M2=glmmTMB(terri ~ SSS + agri5 + X*Y + year + (1|fyear) + (1|id), family=nbinom2, data=dataS)
M3=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec  + (1|fyear)  + (1|id), family=nbinom2, data=dataS)
M4=glmmTMB(terri ~ SSS + agri5 + X*Y + year*shan + year*open + (1|fyear) + (1|id), family=nbinom2, data=dataS)
M5=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec + year*shan + year*open + (1|fyear) + (1|id), family=nbinom2, data=dataS)
output1<-model.sel(M1,M2,M3,M4,M5)
# AICc Table
output1
output2=model.sel(M4,M5)
#tehdään model averaging
summary(model.avg(output2, revised.var = TRUE))
summary(M5)
summary(M4)
getwd()
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB","lme4","MASS","MuMIn","mgcv")
lapply(paketit,library,character.only=T)
data<-read.csv("OrtolanBunting.csv")
names(data)
str(data)
summary(data)
#tarkasta kaikkien luokkien muoto
data$id<-as.factor(data$id)
#vuodelle oma faktori-muuttuja
data$fyear<-as.factor(data$year)
#outliers
dotchart(data$terri, main= "territories")
dotchart(data$prec, main= "precipitation")
dotchart(data$temp, main= "temperature")
dotchart(data$open, main= "spring sown")
#reviirien tiheys
dataS$terriD=dataS$terri/dataS$area
summary(dataS$terriD)
getwd()
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB","lme4","MASS","MuMIn","mgcv")
lapply(paketit,library,character.only=T)
data<-read.csv("OrtolanBunting.csv")
names(data)
str(data)
summary(data)
#tarkasta kaikkien luokkien muoto
data$id<-as.factor(data$id)
#vuodelle oma faktori-muuttuja
data$fyear<-as.factor(data$year)
#outliers
dotchart(data$terri, main= "territories")
dotchart(data$prec, main= "precipitation")
dotchart(data$temp, main= "temperature")
dotchart(data$open, main= "spring sown")
dotchart(data$SSS, main= "small-scale structures")
hist(data$terri)
#kuinka monta käyntikertaa per osapopulaatio?
table(data$id)
#relationships
pairs.panels(data[,c(3:21)])
sort(table(data$id))
hist(data$terri)
table(data$terri)
getwd()
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB","lme4","MASS","MuMIn","mgcv")
lapply(paketit,library,character.only=T)
data<-read.csv("OrtolanBunting.csv")
names(data)
str(data)
summary(data)
#tarkasta kaikkien luokkien muoto
data$id<-as.factor(data$id)
#vuodelle oma faktori-muuttuja
data$fyear<-as.factor(data$year)
#outliers
dotchart(data$terri, main= "N territories")
dotchart(data$prec, main= "precipitation")
dotchart(data$temp, main= "temperature")
dotchart(data$open, main= "open (spring sown)")
dotchart(data$SSS, main= "SSS (small-scale structures)")
hist(data$terri)
table(data$terri)
sort(table(data$id))
#relationships
pairs.panels(data[,c(3:21)])
#plottailua
xyplot(terri~fyear|id, data=data)
boxplot(terri~fyear, data=data)
boxplot(terri~id, data=data)
xyplot(terri~SSS, data=data)
xyplot(terri~open, data=data)
xyplot(terri~cover, data=data)
#Aksun esimerkit (näissä mukana NDVI):
#m1=glmmTMB(N ~Year + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m2=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m3=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Temp + Year*Rain + Year*NDVI + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m4=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Cropdiv + Year*Plough + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m5=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Temp + Year*Rain + Year*NDVI + Year*Cropdiv + Year*Plough + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
dataS=data %>%
mutate_at(c(2:3,5:7,9:20), funs(c(scale(.))))
M1=glmmTMB(terri ~ year + (1|fyear)+ (1|id), family=nbinom2, data=dataS)
M2=glmmTMB(terri ~ SSS + agri5 + X*Y + year + (1|fyear) + (1|id), family=nbinom2, data=dataS)
M3=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec  + (1|fyear)  + (1|id), family=nbinom2, data=dataS)
M4=glmmTMB(terri ~ SSS + agri5 + X*Y + year*shan + year*open + (1|fyear) + (1|id), family=nbinom2, data=dataS)
M5=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec + year*shan + year*open + (1|fyear) + (1|id), family=nbinom2, data=dataS)
output1<-model.sel(M1,M2,M3,M4,M5)
# AICc Table
output1
output2=model.sel(M4,M5)
#tehdään model averaging
summary(model.avg(output2, revised.var = TRUE))
summary(M5)
summary(M4)
#reviirien tiheys
dataS$terriD=dataS$terri/dataS$area
summary(dataS$terriD)
pairs.panels(dataS[,c(3:21)])
pairs.panels(dataS[,c(3:22)])
G1=gamm(terriD ~ s(year),random=list(fyear=~1,id=~1), family=tw(), data=dataS)
G1=gamm(terriD ~ s(year), random=list(fyear=~1,id=~1), family=neg.bin(), data=dataS)
G1=gamm(terriD ~ s(year), random=list(fyear=~1,id=~1), family=neg.bin(theta=1.4), data=dataS)
op=par(mfrow=c(2,2))
plot(G1$gam,select=c(1))
plot(G1$gam,select=c(2))
plot(G1$gam,select=c(3))
E=resid(G1$lme, type="normalized")
F=fitted(G1$lme)
plot(x=F, y=E,xlab="fitted values", ylab="Residuals", cex=0.3)
par(op)
G1=gamm(terriD ~ s(year), random=list(fyear=~1,id=~1), data=dataS)
G2=gamm(terriD ~ s(SSS) + s(agri5) + s(X,Y) +s(year), random=list(fyear=~1,id=~1), data=dataS)
G1=gamm(terriD ~ s(SSS) + s(agri5) + s(X,Y) +s(year), random=list(fyear=~1,id=~1), data=dataS)
op=par(mfrow=c(2,2))
plot(G1$gam,select=c(1))
plot(G1$gam,select=c(2))
plot(G1$gam,select=c(3))
plot(G1$gam,select=c(4))
E=resid(G1$lme, type="normalized")
F=fitted(G1$lme)
plot(x=F, y=E,xlab="fitted values", ylab="Residuals", cex=0.3)
par(op)
G3=gamm(terriD ~ s(SSS) + s(agri5) + s(X,Y) + s(year) + s(year,temp) + s(year,prec), random=list(fyear=~1,id=~1), data=dataS)
G1=gamm(terriD ~ s(year), random=list(fyear=~1,id=~1), data=dataS)
G2=gamm(terriD ~ s(SSS) + s(agri5) + s(X,Y) + s(year), random=list(fyear=~1,id=~1), data=dataS)
G3=gamm(terriD ~ s(SSS) + s(agri5) + s(X,Y) + s(year) + s(year,temp) + s(year,prec), random=list(fyear=~1,id=~1), data=dataS)
G4=gamm(terriD ~ s(SSS) + s(agri5) + s(X,Y) + s(year) + s(year,shan) + s(year,open), random=list(fyear=~1,id=~1), data=dataS)
G5=gamm(terriD ~ s(SSS) + s(agri5) + s(X,Y) + s(year) + s(year,shan) + s(year,open)+ s(year,temp) + s(year,prec) random=list(fyear=~1,id=~1), data=dataS)
G5=gamm(terriD ~ s(SSS) + s(agri5) + s(X,Y) + s(year) + s(year,shan) + s(year,open)+ s(year,temp) + s(year,prec), random=list(fyear=~1,id=~1), data=dataS)
op=par(mfrow=c(2,2))
plot(G2$gam,select=c(1))
plot(G2$gam,select=c(2))
plot(G2$gam,select=c(3))
plot(G2$gam,select=c(4))
E=resid(G1$lme, type="normalized")
F=fitted(G1$lme)
plot(x=F, y=E,xlab="fitted values", ylab="Residuals", cex=0.3)
par(op)
G2=gamm(terriD ~ SSS + agri5 + s(X,Y) + s(year), random=list(fyear=~1,id=~1), data=dataS)
op=par(mfrow=c(2,2))
plot(G2$gam,select=c(1))
plot(G2$gam,select=c(2))
plot(G2$gam,select=c(3))
plot(G2$gam,select=c(4))
E=resid(G1$lme, type="normalized")
F=fitted(G1$lme)
plot(x=F, y=E,xlab="fitted values", ylab="Residuals", cex=0.3)
par(op)
plot(terriD~Y)
getwd()
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB","lme4","MASS","MuMIn","mgcv")
lapply(paketit,library,character.only=T)
data<-read.csv("OrtolanBunting.csv")
names(data)
str(data)
summary(data)
#tarkasta kaikkien luokkien muoto
data$id<-as.factor(data$id)
#vuodelle oma faktori-muuttuja
data$fyear<-as.factor(data$year)
#outliers
dotchart(data$terri, main= "N territories")
dotchart(data$prec, main= "precipitation")
dotchart(data$temp, main= "temperature")
dotchart(data$open, main= "open (spring sown)")
dotchart(data$SSS, main= "SSS (small-scale structures)")
hist(data$terri)
table(data$terri)
sort(table(data$id))
#relationships
pairs.panels(data[,c(3:21)])
#plottailua
xyplot(terri~fyear|id, data=data)
boxplot(terri~fyear, data=data)
boxplot(terri~id, data=data)
xyplot(terri~SSS, data=data)
xyplot(terri~open, data=data)
xyplot(terri~cover, data=data)
#Aksun esimerkit (näissä mukana NDVI):
#m1=glmmTMB(N ~Year + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m2=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m3=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Temp + Year*Rain + Year*NDVI + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m4=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Cropdiv + Year*Plough + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m5=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Temp + Year*Rain + Year*NDVI + Year*Cropdiv + Year*Plough + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
dataS=data %>%
mutate_at(c(2:3,5:7,9:20), funs(c(scale(.))))
#reviirien tiheys
dataS$terriD=dataS$terri/dataS$area
summary(dataS$terriD)
xyplot(terriD~Y, data=dataS)
xyplot(terriD~Y|X, data=dataS)
xyplot(Y~X, data=dataS)
xyplot(terriD~Y, data=dataS)
xyplot(terriD~X, data=dataS)
ggplot(dataS,aes(x=terriD, y=Y))+geom_point()
ggplot(dataS,aes(x=Y, y=terriD))+geom_point()+smooth()
ggplot(dataS,aes(x=Y, y=terriD))+geom_point()+geom_smooth()
pairs.panels(dataS[,c("terriD","agri5)])
pairs.panels(dataS[,c("terriD","agri5"")])
pairs.panels(dataS[,c("terriD","agri5")])
pairs.panels(dataS[,c("terriD","year","agri5","prec","temp","shan","open","SSS","X","Y")])
pairs.panels(dataS[,c("terriD","fyear","agri5","prec","temp","shan","open","SSS","X","Y")])
plot(terriD~fyear, data=dataS)
plot(terriD~year, data=dataS)
plot(terri~year, data=dataS)
plot(terri~fyear, data=dataS)
plot(terriD~fyear, data=dataS)
plot(terriD~year, data=dataS)
25/20
4/20
2720
2/20
pairs.panels(dataS[,c("terriD","year","agri5","prec","temp","shan","open","SSS","X","Y")])
G1=gam(terriD ~ s(year), family=tw, data=dataS)
G2=gam(terriD ~ s(year), family=tw, data=dataS)
op=par(mfrow=c(2,2))
plot(G2$gam,select=c(1))
op=par(mfrow=c(2,2))
plot(G2$gam,select=c(1))
plot(G2$gam,select=c(1))
G1=gam(terriD ~ s(year), family=tw, random=list(fyear=~1,id=~1), data=dataS)
G2=gam(terriD ~ s(year), family=tw, random=list(fyear=~1,id=~1), data=dataS)
op=par(mfrow=c(2,2))
plot(G2$gam,select=c(1))
summary(G2)
G2=gam(terriD ~ s(year), family=tw, random=list(fyear=~1,id=~1), data=dataS)
summary(G2)
G2=gamm(terriD ~ s(year), family=tw(p=1.225), random=list(fyear=~1,id=~1), data=dataS)
G2=gamm(terriD ~ s(year), family=Tweedie(p=1.225), random=list(fyear=~1,id=~1), data=dataS)
summary(terriD)
summary(dataS$terriD)
X <- dataS$terriD[dataS$terriD<max(dataS$terriD)]
X
hist(X,breaks=c(seq(1,1e5,1000),Inf),xlim=c(0,100000))
summary(dataS$terriD)
G1=gamm(terriD ~ s(year), random=list(fyear=~1,id=~1), data=dataS, family=Tweedie(p=1.225))
getwd()
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB","lme4","MASS","MuMIn","mgcv")
lapply(paketit,library,character.only=T)
data<-read.csv("OrtolanBunting.csv")
names(data)
str(data)
summary(data)
#tarkasta kaikkien luokkien muoto
data$id<-as.factor(data$id)
#vuodelle oma faktori-muuttuja
data$fyear<-as.factor(data$year)
#outliers
dotchart(data$terri, main= "N territories")
dotchart(data$prec, main= "precipitation")
dotchart(data$temp, main= "temperature")
dotchart(data$open, main= "open (spring sown)")
dotchart(data$SSS, main= "SSS (small-scale structures)")
hist(data$terri)
table(data$terri)
sort(table(data$id))
#relationships
pairs.panels(data[,c(3:21)])
#plottailua
xyplot(terri~fyear|id, data=data)
boxplot(terri~fyear, data=data)
boxplot(terri~id, data=data)
xyplot(terri~SSS, data=data)
xyplot(terri~open, data=data)
xyplot(terri~cover, data=data)
#Aksun esimerkit (näissä mukana NDVI):
#m1=glmmTMB(N ~Year + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m2=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m3=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Temp + Year*Rain + Year*NDVI + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m4=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Cropdiv + Year*Plough + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m5=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Temp + Year*Rain + Year*NDVI + Year*Cropdiv + Year*Plough + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
dataS=data %>%
mutate_at(c(2:3,5:7,9:20), funs(c(scale(.))))
M1=glmmTMB(terri ~ year + (1|fyear)+ (1|id), family=nbinom2, data=dataS)
M2=glmmTMB(terri ~ SSS + agri5 + X*Y + year + (1|fyear) + (1|id), family=nbinom2, data=dataS)
M3=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec  + (1|fyear)  + (1|id), family=nbinom2, data=dataS)
M4=glmmTMB(terri ~ SSS + agri5 + X*Y + year*shan + year*open + (1|fyear) + (1|id), family=nbinom2, data=dataS)
M5=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec + year*shan + year*open + (1|fyear) + (1|id), family=nbinom2, data=dataS)
output1<-model.sel(M1,M2,M3,M4,M5)
# AICc Table
output1
output2=model.sel(M4,M5)
#tehdään model averaging
summary(model.avg(output2, revised.var = TRUE))
summary(M5)
summary(M4)
#reviirien tiheys
dataS$terriD=dataS$terri/dataS$area
summary(dataS$terriD)
#relationships
pairs.panels(dataS[,c(3:22)])
pairs.panels(dataS[,c("terriD","year","agri5","prec","temp","shan","open","SSS","X","Y")])
pairs.panels(dataS[,c("terriD","year","agri5","prec","temp","shan","open","SSS","X","Y")])
pairs.panels(dataS[,c("terriD","fyear","agri5","prec","temp","shan","open","SSS","X","Y")])
plot(dataS$terriD~year)
plot(dataS$terriD~dataS$year)
hist(dataS$terriD~dataS$year)
plot(dataS$terriD~dataS$year)
plot(dataS$terri~dataS$year)
plot(dataS$terri~dataS$fyear)
ggplot(dataS, aes(x=fyear,y=terri))+ geom_smooth()
ggplot(dataS, aes(x=fyear,y=terri))+ geom_hist() + geom_smooth()
ggplot(dataS, aes(x=fyear,y=terri))+ geom_bar() + geom_smooth()
plot(dataS$terri~dataS$fyear)
ggplot(dataS, aes(x=fyear,y=terri))+ geom_boxplot() + geom_smooth()
ggplot(dataS, aes(x=year,y=terri))+ geom_boxplot() + geom_smooth()
ggplot(dataS, aes(x=year,y=terri))+ geom_point() + geom_smooth()
ggplot(dataS, aes(x=year,y=terriD))+ geom_point() + geom_smooth()
pairs.panels(dataS[,c("terriD","fyear","neo","agri5","prec","temp","shan","open","SSS","X","Y")])
pairs.panels(dataS[,c("terriD","fyear","neo","agri5","shan","open","X","Y")])
pairs.panels(dataS[,c("terriD","fyear","neo","agri5","shan","open","X","Y")])
pairs.panels(dataS[,c("terriD","year","neo","agri5","shan","open","X","Y")])
ggplot(dataS, aes(x=X,y=terriD))+ geom_point() + geom_smooth()
ggplot(dataS, aes(x=year,y=terriD))+ geom_point() + geom_smooth()
pairs.panels(dataS[,c("terriD","year","neo","agri5","shan","open","X","Y")])
#neot offsetilla, glmm
glmmTMB(neo~offset(area) + year + X*Y + (1|fyear) + (1|id), family=nbinom2, data=dataS)
#neot offsetilla, glmm
NO1=glmmTMB(neo~offset(area) + year + X*Y + (1|fyear) + (1|id), family=nbinom2, data=data)
#neot offsetilla, glmm
NO1=glmmTMB(terri ~ offset(area) + year + X*Y + (1|fyear) + (1|id), family=nbinom2, data=data)
#neot offsetilla, glmm
NO1=glmmTMB(terri ~ offset(area) + neo + year + X*Y + (1|fyear) + (1|id), family=nbinom2, data=data)
#neot offsetilla, glmm
NO1=lme(terri ~ offset(area) + neo + year + X*Y + (1|fyear) + (1|id), family=nbinom2, data=data)
pairs.panels(dataS[,c(3:22)])
getwd()
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB","lme4","MASS","MuMIn","mgcv")
lapply(paketit,library,character.only=T)
data<-read.csv("OrtolanBunting.csv")
names(data)
str(data)
summary(data)
#tarkasta kaikkien luokkien muoto
data$id<-as.factor(data$id)
#vuodelle oma faktori-muuttuja
data$fyear<-as.factor(data$year)
#outliers
dotchart(data$terri, main= "N territories")
dotchart(data$prec, main= "precipitation")
dotchart(data$temp, main= "temperature")
dotchart(data$open, main= "open (spring sown)")
dotchart(data$SSS, main= "SSS (small-scale structures)")
hist(data$terri)
table(data$terri)
sort(table(data$id))
#relationships
pairs.panels(data[,c(3:21)])
#plottailua
xyplot(terri~fyear|id, data=data)
boxplot(terri~fyear, data=data)
boxplot(terri~id, data=data)
xyplot(terri~SSS, data=data)
xyplot(terri~open, data=data)
xyplot(terri~cover, data=data)
#Aksun esimerkit (näissä mukana NDVI):
#m1=glmmTMB(N ~Year + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m2=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m3=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Temp + Year*Rain + Year*NDVI + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m4=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Cropdiv + Year*Plough + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
#m5=glmmTMB(N ~SSS + Landscape + X + Y + X*Y + Year*Temp + Year*Rain + Year*NDVI + Year*Cropdiv + Year*Plough + (1|fYear) + (1|Site), family=nbinom2, data=Embhor)
dataS=data %>%
mutate_at(c(2:3,5:7,9:20), funs(c(scale(.))))
M1=glmmTMB(terri ~ year + (1|fyear)+ (1|id), family=nbinom2, data=dataS)
M2=glmmTMB(terri ~ SSS + agri5 + X*Y + year + (1|fyear) + (1|id), family=nbinom2, data=dataS)
M3=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec  + (1|fyear)  + (1|id), family=nbinom2, data=dataS)
M4=glmmTMB(terri ~ SSS + agri5 + X*Y + year*shan + year*open + (1|fyear) + (1|id), family=nbinom2, data=dataS)
M5=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec + year*shan + year*open + (1|fyear) + (1|id), family=nbinom2, data=dataS)
output1<-model.sel(M1,M2,M3,M4,M5)
# AICc Table
output1
output2=model.sel(M4,M5)
#tehdään model averaging
summary(model.avg(output2, revised.var = TRUE))
summary(M5)
summary(M4)
#reviirien tiheys
dataS$terriD=dataS$terri/dataS$area
summary(dataS$terriD)
#relationships
pairs.panels(dataS[,c(3:22)])
pairs.panels(dataS[,c("terriD","fyear","agri5","prec","temp","shan","open","SSS","X","Y")])
ggplot(dataS, aes(x=year,y=terriD))+ geom_point() + geom_smooth()
pairs.panels(dataS[,c("terriD","year","neo","agri5","shan","open","X","Y")])
G1=gam(terriD ~  agri5 + SSS + s(Y*X) + s(fyear,bs="re") + s(id,bs="re"), data=dataS, family=Tweedie(p=1.225))
G1=gam(terriD ~  agri5 + SSS + s(Y*X) + s(fyear,bs="re") + s(id,bs="re"), data=dataS, family=tw)
G1=gam(terriD ~  agri5 + SSS + s(Y) + s(fyear,bs="re") + s(id,bs="re"), data=dataS, family=tw)
summary(G1)
G1=gam(terriD ~  s(year)+ s(fyear,bs="re") + s(id,bs="re"), data=dataS, family=tw))
G1=gam(terriD ~  s(year)+ s(fyear,bs="re") + s(id,bs="re"), data=dataS, family=tw)
G2=gam(terriD ~  agri5 + SSS + s(Y) + s(fyear,bs="re") + s(id,bs="re"), data=dataS, family=tw)
AIC(G1,G2)
G3=gam(terriD ~  s(year)+ s(fyear,bs="re") + s(id,bs="re") + agri5 + SSS + s(Y) + year*temp + year*prec, data=dataS, family=tw)
AIC(G2,G3)
G3=gam(terriD ~  s(year)+ s(fyear,bs="re") + s(id,bs="re") + agri5 + SSS + s(Y) + year*shan + year*open, data=dataS, family=tw)
G3=gam(terriD ~ agri5 + SSS + s(Y) + year*temp + year*prec + s(fyear,bs="re") + s(id,bs="re"), data=dataS, family=tw)
G3=gam(terriD ~ agri5 + SSS + s(Y) + year*temp + year*prec + s(fyear,bs="re") + s(id,bs="re"), data=dataS, family=tw)
G4=gam(terriD ~ agri5 + SSS + s(Y) + year*shan + year*open + s(fyear,bs="re") + s(id,bs="re"), data=dataS, family=tw)
G3=gam(terriD ~ agri5 + SSS + s(Y) + year*temp + year*prec + s(fyear,bs="re") + s(id,bs="re"), data=dataS, family=tw)
G4=gam(terriD ~ agri5 + SSS + s(Y) + year*shan + year*open + s(fyear,bs="re") + s(id,bs="re"), data=dataS, family=tw)
#G4=gamm
AIC(G3,G4)
G5=gam(terriD ~ agri5 + SSS + s(Y) + year*shan + year*open + year*temp + year*prec + s(fyear,bs="re") + s(id,bs="re"), data=dataS, family=tw)
G5=gam(terriD ~ agri5 + SSS + s(Y) + year*shan + year*open + year*temp + year*prec + s(fyear,bs="re") + s(id,bs="re"), data=dataS, family=tw)
#G4=gamm(
AIC(G4,G5)
AIC(G1,G2,G3,G4,G5)
op=par(mfrow=c(2,2))
plot(G3$gam,select=c(1))
G3$gam
summary(G3)
plot(G3)
op=par(mfrow=c(2,2))
plot(G3$gam,select=c(1))
summary(G3)
plot(G3)
G3$gam
M1=glmmTMB(terri ~ year + offset(log(area)) + (1|fyear)+ (1|id), family=nbinom2, data=dataS)
summary(M1)
M2=glmmTMB(terri ~ SSS + agri5 + X*Y + year + offset(log(area))+ (1|fyear) + (1|id), family=nbinom2, data=dataS)
M3=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec  + offset(log(area))+ (1|fyear)  + (1|id), family=nbinom2, data=dataS)
M4=glmmTMB(terri ~ SSS + agri5 + X*Y + year*shan + year*open + offset(log(area))+ (1|fyear) + (1|id), family=nbinom2, data=dataS)
M5=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec + year*shan + year*open + offset(log(area))+ (1|fyear) + (1|id), family=nbinom2, data=dataS)
AIC(M1,M2,M3,M4,M5)
M1=glmmTMB(terri ~ year + log(area) + (1|fyear)+ (1|id), family=nbinom2, data=dataS)
M2=glmmTMB(terri ~ SSS + agri5 + X*Y + year + log(area)+ (1|fyear) + (1|id), family=nbinom2, data=dataS)
M3=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec  + log(area)+ (1|fyear)  + (1|id), family=nbinom2, data=dataS)
M4=glmmTMB(terri ~ SSS + agri5 + X*Y + year*shan + year*open + log(area)+ (1|fyear) + (1|id), family=nbinom2, data=dataS)
M5=glmmTMB(terri ~ SSS + agri5 + X*Y + year*temp + year*prec + year*shan + year*open + log(area) + (1|fyear) + (1|id), family=nbinom2, data=dataS)
summary(M1)
AIC(M1,M2,M3,M4,M5)
M6=glmmTMB(terri ~ SSS + agri5 + X*Y + temp + prec + shan + open + log(area) + (1|fyear) + (1|id), family=nbinom2, data=dataS)
summary(M6)
M6=glmmTMB(terri ~ SSS + agri5 + X*Y + temp + prec + shan + open + offset(log(area)) + (1|fyear) + (1|id), family=nbinom2, data=dataS)
M6=glmmTMB(terri ~ SSS + agri5 + X*Y + temp + prec + shan + open + offset(log(area)) + (1|fyear) + (1|id), family=nbinom2, data=dataS)
summary(M6)
M6=glmmTMB(terri ~ SSS + agri5 + X+Y + temp + prec + shan + open + offset(log(area)) + (1|fyear) + (1|id), family=nbinom2, data=dataS)
M6=glmmTMB(terri ~ SSS + agri5 + X+Y + temp + prec + shan + open + offset(log(area)) + (1|fyear) + (1|id), family=nbinom2, data=dataS)
summary(M6)
M6=glmmTMB(terri ~ SSS + agri5 + Y  + shan  + offset(log(area)) + (1|fyear) + (1|id), family=nbinom2, data=dataS)
M6=glmmTMB(terri ~ SSS + agri5 + Y  + shan  + offset(log(area)) + (1|fyear) + (1|id), family=nbinom2, data=dataS)
summary(M6)
M6=glmmTMB(terri ~ Abuild + Astream + Aroad + Ariver + agri5 + Y  + shan  + offset(log(area)) + (1|fyear) + (1|id), family=nbinom2, data=dataS)
M6=glmmTMB(terri ~ Abuild + Astream + Aroad + Ariver + agri5 + Y  + shan  + offset(log(area)) + (1|fyear) + (1|id), family=nbinom2, data=dataS)
summary(M6)
