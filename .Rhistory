getwd()
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB","tidyverse")
lapply(paketit,library,character.only=T)
getwd()
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB")
lapply(paketit,library,character.only=T)
data<-read.csv("OrtolanBunting.csv")
#tarkasta kaikkien luokkien muoto
data$id<-as.factor(data$id)
#pitäisikö vuosi olla factor vai integer?
data$fyear<-as.factor(data$year)
names(data)
summary(data)
str(data)
#outliers
dotchart(data$terri, main= "territories")
dotchart(data$prec, main= "precipitation")
dotchart(data$prec, main= "precipitation")
dotchart(data$temp, main= "temperature")
dotchart(data$open, main= "spring sown")
dotchart(data$SSS, main= "small-scale structures")
hist(data$terri)
#relationships
pairs.panels(data[,c(4:7,8:9,21:23,28:30)])
#plottailua
xyplot(terri~year|id, data=data)
boxplot(terri~year, data=data)
boxplot(data$terri~data$id, data=data)
xyplot(terri~SSS, data=data)
xyplot(terri~open, data=data)
boxplot(terri~year, data=data)
boxplot(terri~id, data=data)
xyplot(terri~SSS, data=data)
xyplot(terri~open, data=data)
xyplot(terri~cover, data=data)
#varsinaiset mallit:
M1=glmmTMB(terri ~ year + (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M1)
M2=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year + (1|fyear) + (1|id), family=nbinom2, data=data)
M3=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year*temp + year*prec + year*ndvi  + (1|fyear) + (1|id), family=list(family="nbinom2",link="log"), data=data)
M3=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year*temp + year*prec + year*ndvi  + (1|fyear) + (1|id), family=nbinom2, data=data)
View(data)
#varsinaiset mallit:
M1=glmmTMB(terri ~ agri5 + (1|fyear) + (1|id), family=nbinom2, data=data)
summary(M1)
#varsinaiset mallit:
M1=glmmTMB(terri ~ year + (1|id), family=nbinom2, data=data)
summary(M1)
#varsinaiset mallit:
M1=glmmTMB(terri ~ year + (1|fyear) + (1|id), family=nbinom2, data=data)
#varsinaiset mallit:
M1=glmmTMB(terri ~ year  + (1|id), family=nbinom2, data=data)
summary(M1)
M2=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year  + (1|id), family=nbinom2, data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5  + X*Y + year  + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5  + X*Y + year  + (1|id), family="nbinom2", data=data)
#varsinaiset mallit:
M1=glmmTMB(terri ~ year  + (1|id), family="nbinom2", data=data)
summary(M1)
M3=glmmTMB(terri ~ SSS + agri5 + X + Y + X*Y + year*temp + year*prec + year*ndvi   + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5  + X*Y + year  + (1|id), family="nbinom2", data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5  + year+ X*Y  + (1|id), family="nbinom2", data=data)
M2=glmmTMB(terri ~ SSS + agri5  + year+ X*Y  + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ year+ X*Y  + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5  +  X*Y  + (1|id), family=nbinom2, data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5  +  year + (1|id), family=nbinom2, data=data)
#varsinaiset mallit:
M1=glmmTMB(terri ~ year  + (1|id), family=nbinom2, data=data)
summary(M1)
#varsinaiset mallit:
M1=glmmTMB(terri ~ fyear  + (1|id), family=nbinom2, data=data)
summary(M1)
M2=glmmTMB(terri ~ SSS + agri5  +  fyear+ X*Y  + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5  +  fyear  + (1|id), family=nbinom2, data=data)
summary(M2)
M2=glmmTMB(terri ~ SSS + agri5  +  fyear + X*Y  + (1|id), family=nbinom2, data=data)
M2=glmmTMB(terri ~ SSS + agri5  +  year  + (1|id), family=nbinom2, data=data)
